<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
     xmlns:bal="http://wixtoolset.org/schemas/v4/wxs/bal"
     xmlns:util="http://wixtoolset.org/schemas/v4/wxs/util">

  <Bundle Name="Ferrum Streaming Control Technology™ Driver"
          Version="$(var.Version)"
          Manufacturer="HEM Sp. z o.o."
          UpgradeCode="114bae33-cd52-42db-995e-a40506dc5626">

    <BootstrapperApplication>
      <bal:WixStandardBootstrapperApplication
          LicenseFile="$(var.EULA)"
          ShowVersion="yes"
          Theme="rtfLargeLicense"
          SuppressOptionsUI="yes"
          SuppressRepair="yes"
      />
    </BootstrapperApplication>

    <Chain>
      <!-- VC++ Redist 2015-2022 -->
      <ExePackage 
          Name="Microsoft Visual C++ 2015–2022 Redistributable (x64)"
          SourceFile="vc_redist.x64.exe"
          Cache="keep"
          Permanent="yes"
          Vital="yes"
          InstallArguments="/quiet /norestart"
          DetectCondition="WixBundleInstalled OR WixMsiProductInstalled">
        <ExitCode Behavior="success" Value="0" />
        <ExitCode Behavior="success" Value="3010" />
      </ExePackage>

      <!-- FSCT Service MSI -->
      <MsiPackage 
          SourceFile="FSCTServiceInstaller.msi"
          Name="FSCT Driver Service"
          Vital="yes" />
    </Chain>

  </Bundle>
</Wix>
